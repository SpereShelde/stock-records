

<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>韭菜日记</title>
      <link href="https://fonts.googleapis.com/css?family=Montserrat:500,700&display=swap&subset=latin-ext" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600&display=swap&subset=latin-ext" rel="stylesheet">
      <link href="/static/css/bootstrap.css" rel="stylesheet">
      <link href="/static/css/styles.css" rel="stylesheet">
      <!-- Favicon  -->
      <link rel="icon" href="">
      <style>
         .header {
         background: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.5)), url("/static/img/header-background.jpg") center center no-repeat;
         background-size: cover;
         }
      </style>
   </head>
   <body data-spy="scroll" data-target=".fixed-top">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-md navbar-dark navbar-custom fixed-top">
         <!-- Text Logo - Use this if you don't have a graphic logo -->
         <a class="navbar-brand logo-text page-scroll" href="/">美股韭菜日记</a>
         <!-- Mobile Menu Toggle Button -->
         <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
         <span class="navbar-toggler-awesome fas fa-bars"></span>
         <span class="navbar-toggler-awesome fas fa-times"></span>
         </button>
         <!-- end of mobile menu toggle button -->
         <div class="collapse navbar-collapse" id="navbarsExampleDefault">
            <ul class="navbar-nav ml-auto">
               <li class="nav-item">
                  <a class="nav-link page-scroll" href="/">记录 <span class="sr-only">(current)</span></a>
               </li>
               <li class="nav-item">
                  <a class="nav-link page-scroll" href="/edit">修改</a>
               </li>
            </ul>
         </div>
      </nav>
      <!-- end of navbar -->
      <!-- end of navbar -->
      <!-- Header -->
      <header id="header" class="header">
         <div class="header-content">
         <div class="container">
            <div class="row">
            <div class="col-lg-12">
            <div class="input-group">
                             <select class="custom-select" id="users">
                               <option id="all" value="all" selected>全部</option>
                               {{#each users}}
                               <option id="{{ name }}" value="{{ name }}">{{ name }}</option>
                               {{/each}}
                            </select>
                               <div class="input-group-append">
                                   <label class="input-group-text" for="users" id="balance">现金余额: -/- 美元</label>
                                 </div>
                           </div>
                           </div>
               <div class="col-lg-12"  style="margin-top: 20px">
                  <table class="table table-striped table-dark">
                  <thead>
                  <tr>
                  <th scope="col">序号</th>
                  <th scope="col">所有人</th>
                  <th scope="col">时间</th>
                  <th scope="col">股票号</th>
                  <th scope="col">操作</th>
                  <th scope="col">数量</th>
                  <th scope="col">单价</th>
                  </tr>
                  </thead>
                  <tbody id = 'table'>
                  {{#each records}}
                  <tr>
                  {{#if valid}}
                    <th scope="row">{{ number }}</th>
                      <td>{{ name }}</td>
                      <td>{{ time }}</td>
                      <td>{{ stockId }}</td>
                      <td>{{ action }}</td>
                      <td>{{ amount }}</td>
                      <td>{{ price }}</td>
                  {{else}}
                    <th scope="row"><s>{{ number }}</s></th>
                      <td><s>{{ name }}</s></td>
                      <td><s>{{ time }}</s></td>
                      <td><s>{{ stockId }}</s></td>
                      <td><s>{{ action }}</s></td>
                      <td><s>{{ amount }}</s></td>
                      <td><s>{{ price }}</s></td>
                  {{/if}}
                  </tr>
                  {{/each}}
                  </tbody>
                  </table>
                  </div>
                  <!-- end of col -->
               </div>
               <!-- end of row -->
            </div>
            <!-- end of container -->
         </div>
         <!-- end of header-content -->
      </header>
      <!-- end of header -->
      <!-- end of header -->
      <!-- Footer -->
      <div class="footer">
         <div class="container">
            <div class="row">
               <div class="col-md-6">
                  <div class="text-container about">
                     <h4>美股韭菜日记</h4>
                     <p class="white">记录美股韭菜们被收割的明细</p>
                  </div>
                  <!-- end of text-container -->
               </div>
               <!-- end of col -->
            </div>
            <!-- end of row -->
         </div>
         <!-- end of container -->
      </div>
      <!-- end of footer -->
      <!-- end of footer -->
      <!-- Copyright -->
      <div class="copyright">
         <div class="container">
            <div class="row">
               <div class="col-lg-12">
                  <p class="p-small">Copyright © 2020 <a href="">Zifan Wang</a> - All rights reserved</p>
               </div>
               <!-- end of col -->
            </div>
            <!-- enf of row -->
         </div>
         <!-- end of container -->
      </div>
      <!-- end of copyright -->
      <!-- end of copyright -->
      <!-- Scripts -->
      <script src="/static/js/jquery.min.js"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
      <script src="/static/js/bootstrap.min.js"></script> <!-- Bootstrap framework -->
      <script >
            $("#all").prop( "selected", true );
           $("#users").change(function(){
             var user=$('#users').val();
             if (user === "all") {
               window.location.reload()
             } else {
               $.post("http://127.0.0.1:2020/user", { name: user },
               (data,status) => {
                   $('#balance').text("现金余额: " + data.balance + " 美元");
                   const records = data.records;
                   $("#table").html('<tbody id = \'table\'></tbody>');
                      for (let i = 0; i < records.length; i += 1) {
                        $("#table").append(`<tr><th scope="row">${records[i].number}</th><td>${records[i].name}</td><td>${records[i].time}</td><td>${records[i].stockId}</td><td>${records[i].action}</td><td>${records[i].amount}</td><td>${records[i].price}</td>`);
                      }
               });
             }
           });
      </script>
       <!--
       <script src="/static/js/scripts.js"></script>
       -->
   </body>
</html>

